IF EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND name = 'PRC_GEN_RPT_LIQ')
BEGIN
    DROP PROCEDURE PRC_GEN_RPT_LIQ;
END
GO

CREATE PROCEDURE PRC_GEN_RPT_LIQ
    @ANIO_DESDE INT,
	@ANIO_HASTA INT,
	@MES_DESDE INT,
	@MES_HASTA INT
AS
BEGIN
	SELECT LIQ.ID,LIQ.descripcion,LIQ.ANIO,LIQ.MES,C.nombre,SUM(TC.monto) 
	FROM LIQUIDACION LIQ
	JOIN Tabulado T ON T.ID_LIQUIDACION=LIQ.id
	JOIN TABULADO_CONCEPTO TC ON TC.ID_TABULADO =T.id
	JOIN CONCEPTO C ON C.id=TC.ID_CONCEPTO
	WHERE ANIO > @ANIO_DESDE AND ANIO < @ANIO_HASTA
	AND MES > @MES_DESDE AND MES < @MES_HASTA 
	GROUP BY LIQ.ID,LIQ.descripcion,LIQ.ANIO,LIQ.MES,C.nombre
	ORDER BY LIQ.ID,LIQ.descripcion,LIQ.ANIO,LIQ.MES,C.nombre
END;
